<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Traxion</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
    font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
    background:#f3f4f6;
    color:#1f2937;
    min-height:100vh;
}

.container-fluid{
    display:flex;
    flex-wrap:wrap;
}

.sidebar{
    width:260px;
    background:#1f2937;
    min-height:100vh;
    padding:25px 20px;
}
.sidebar h2{
    color:#84cc16;
    text-align:center;
    margin-bottom:30px;
    font-size:28px;
}
.menu-item{
    padding:14px 18px;
    border-radius:10px;
    margin-bottom:12px;
    color:#d1d5db;
    font-weight:600;
    cursor:pointer;
    transition:all 0.3s;
}
.menu-item:hover{
    background:#374151;
}
.menu-item.active{
    background:#84cc16;
    color:#1f2937;
}

.content{
    flex:1;
    padding:30px;
    min-width:0;
}

header{
    background:linear-gradient(135deg,#1f2937,#374151);
    padding:30px;
    border-radius:14px;
    margin-bottom:20px;
}
header h1{
    color:#84cc16;
    font-size:32px;
    margin-bottom:8px;
}
.subtitle{
    color:#d1d5db;
    font-size:16px;
}

.filter-bar{
    margin:0 0 20px 0;
}
.filter-bar select{
    padding:12px 16px;
    border-radius:10px;
    border:2px solid #e5e7eb;
    font-size:15px;
    font-weight:600;
    min-width:250px;
    background:#ffffff;
    cursor:pointer;
    transition:border 0.3s;
}
.filter-bar select:focus{
    outline:none;
    border-color:#84cc16;
}

.kpi-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));
    gap:18px;
    margin-bottom:25px;
}

.kpi-card{
    background:#ffffff;
    border:2px solid #e5e7eb;
    border-radius:12px;
    padding:20px;
    transition:transform 0.2s, box-shadow 0.2s;
}
.kpi-card:hover{
    transform:translateY(-2px);
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
.kpi-card.highlight{
    border-left:5px solid #84cc16;
}
.kpi-card.warning{
    border-left:5px solid #f59e0b;
}

.kpi-label{
    font-size:11px;
    font-weight:700;
    color:#6b7280;
    text-transform:uppercase;
    letter-spacing:0.5px;
    margin-bottom:8px;
}
.kpi-value{
    font-size:28px;
    font-weight:800;
    color:#1f2937;
    margin:8px 0;
}
.kpi-value.highlight{
    color:#84cc16;
}
.kpi-subvalue{
    font-size:12px;
    color:#9ca3af;
    margin-top:6px;
    line-height:1.4;
}

.chart-row{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(400px, 1fr));
    gap:20px;
    margin-bottom:25px;
}

.chart-container{
    background:#ffffff;
    border:2px solid #e5e7eb;
    border-radius:12px;
    padding:20px;
    transition:transform 0.2s, box-shadow 0.2s;
}
.chart-container:hover{
    transform:translateY(-2px);
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
.chart-container h3{
    font-size:16px;
    font-weight:700;
    margin-bottom:15px;
    color:#1f2937;
    padding-bottom:10px;
    border-bottom:2px solid #84cc16;
}
canvas{
    max-height:280px;
}

@media (max-width: 1400px){
    .kpi-grid{
        grid-template-columns:repeat(3, 1fr);
    }
}

@media (max-width: 1024px){
    .sidebar{
        width:100%;
        min-height:auto;
    }
    .container-fluid{
        flex-direction:column;
    }
    .kpi-grid{
        grid-template-columns:repeat(2, 1fr);
    }
    .chart-row{
        grid-template-columns:1fr;
    }
}

@media (max-width: 640px){
    .content{
        padding:15px;
    }
    header{
        padding:20px;
    }
    header h1{
        font-size:24px;
    }
    .kpi-grid{
        grid-template-columns:1fr;
    }
    .kpi-value{
        font-size:24px;
    }
    .filter-bar select{
        width:100%;
    }
}
</style>
<link rel="stylesheet" href="scoreseg.css">
</head>

<body>
<section id="seccion-scoreseg" class="seccion-dashboard" style="display:none;">

    <header>
        <h1>Dashboard de Eventos Score Seg</h1>
        <p class="subtitle">Monitoreo de seguridad y comportamiento</p>
    </header>

    <!-- Filtros M√∫ltiples -->
    <div class="chart-container" style="margin-bottom:20px;">
        <h3>Filtros de B√∫squeda</h3>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:15px;">
            <select id="filtroScoreUDN" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todas las UDN</option>
            </select>
            <select id="filtroScoreGerente" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todos los Gerentes</option>
            </select>
            <select id="filtroScoreJefe" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todos los Jefes</option>
            </select>
            <select id="filtroScoreAnio" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todos los A√±os</option>
            </select>
            <select id="filtroScoreMes" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todos los Meses</option>
            </select>
            <select id="filtroScoreSem" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todas las Semanas</option>
            </select>
            <select id="filtroScoreDia" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todos los D√≠as</option>
            </select>
            <select id="filtroScoreCliente" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
                <option value="">Todos los Clientes</option>
            </select>
            <input type="text" id="filtroScoreOperador" placeholder="üîç Buscar Operador" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;font-size:13px;">
            <button onclick="limpiarFiltrosScore()" style="padding:10px;border:2px solid #e5e7eb;border-radius:8px;background:#fff;cursor:pointer;font-weight:600;">
                üóëÔ∏è Limpiar Filtros
            </button>
        </div>
        <div style="margin-top:15px;padding:10px;background:#f3f4f6;border-radius:8px;">
            <span style="font-size:14px;color:#6b7280;">Registros mostrados: <strong id="contadorRegistros">0</strong></span>
        </div>
    </div>

    <!-- Tabla de Score Seg -->
    <div class="chart-container">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
            <h3 style="margin:0;">Detalle de Eventos por Operador</h3>
            <button onclick="exportarScoreExcel()" style="
                background:#84cc16;
                color:#1f2937;
                border:none;
                padding:10px 20px;
                border-radius:8px;
                font-weight:700;
                font-size:14px;
                cursor:pointer;
                transition:all 0.3s;
                box-shadow:0 2px 4px rgba(0,0,0,0.1);
            " onmouseover="this.style.background='#65a30d'" onmouseout="this.style.background='#84cc16'">
                üì• Exportar a Excel
            </button>
        </div>
        
        <div style="overflow-x:auto;">
            <table id="tablaScoreSeg" style="font-size:12px;">
                <thead>
                    <tr>
                        <th>UDN</th>
                        <th>Operador</th>
                        <th>Cliente</th>
                        <th colspan="5" style="background:#dc2626;color:white;">EVENTOS CR√çTICOS</th>
                        <th colspan="5" style="background:#f59e0b;color:white;">EVENTOS MODERADOS</th>
                        <th colspan="4" style="background:#eab308;color:white;">EVENTOS LEVES</th>
                        <th style="background:#1f2937;color:#84cc16;">SCORE</th>
                    </tr>
                    <tr style="background:#f9fafb;">
                        <th colspan="9"></th>
                        <th style="font-size:10px;">Acel</th>
                        <th style="font-size:10px;">Freno</th>
                        <th style="font-size:10px;">Giro D</th>
                        <th style="font-size:10px;">Giro I</th>
                        <th style="font-size:10px;">Veloc</th>
                        <th style="font-size:10px;">Acel</th>
                        <th style="font-size:10px;">Freno</th>
                        <th style="font-size:10px;">Giro D</th>
                        <th style="font-size:10px;">Giro I</th>
                        <th style="font-size:10px;">Veloc</th>
                        <th style="font-size:10px;">Freno</th>
                        <th style="font-size:10px;">Giro D</th>
                        <th style="font-size:10px;">Giro I</th>
                        <th style="font-size:10px;">Veloc</th>
                        <th style="font-size:10px;">Final</th>
                    </tr>
                </thead>
                <tbody id="tablaScoreBody"></tbody>
            </table>
        </div>
    </div>

    </section>
<script src="scoreseg.js"></script>
</body>
</html>